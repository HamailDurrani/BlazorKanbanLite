@using BlazorKanbanLite.Models
@using TaskStatus = BlazorKanbanLite.Models.TaskStatus

@inject IJSRuntime JS

<div class="task-card @GetStatusClass()" draggable="true"
     @ondragstart="OnDragStart">

    <div class="task-title">@Item.Title</div>
    <div class="task-desc">@Item.Description</div>
    <div class="task-desc">@Item.Status</div>

    <div class="task-actions">
        <button class="edit-btn" @onclick="() => OnEdit.InvokeAsync(Item)">Edit</button>
        <button class="delete-btn" @onclick="() => OnDelete.InvokeAsync(Item)">Delete</button>
    </div>

</div>


@code {
    [Parameter]
    public required TaskItem Item { get; set; }

    [Parameter]
    public EventCallback<TaskItem> OnEdit { get; set; }

    [Parameter]
    public EventCallback<TaskItem> OnDelete { get; set; }





    string GetStatusClass()
    {
        return Item.Status switch
        {
            TaskStatus.ToDo => "todo-card",
            TaskStatus.InProgress => "inprogress-card",
            TaskStatus.Done => "done-card",
            _ => ""
        };
    }

    void OnDragStart(DragEventArgs e)
    {
        JS.InvokeVoidAsync("dragHelper.set", Item.Id.ToString());
    }




    Task Edit() => OnEdit.InvokeAsync(Item);
    Task Delete() => OnDelete.InvokeAsync(Item);
}
